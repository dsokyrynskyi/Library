<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

        <changeSet id="5" author="daniel">
            <createTable tableName="BOOK">
                <column name="BOOK_ID" type="INTEGER"/>
                <column name="NAME" type="VARCHAR(250)"/>
                <column name="ISBN" type="VARCHAR(100)"/>
                <column name="PUBLISH_DATE" type="DATE"/>
                <column name="GENRE" type="VARCHAR(100)"/>
                <column name="PUBLISHER" type="INTEGER"/>
            </createTable>
        </changeSet>

        <changeSet id="6" author="daniel">
            <addPrimaryKey tableName="BOOK" columnNames="BOOK_ID"/>
            <addAutoIncrement tableName="BOOK" columnName="BOOK_ID"/>
            <addNotNullConstraint tableName="BOOK" columnName="NAME"/>
            <addUniqueConstraint tableName="BOOK" columnNames="NAME"/>
            <addUniqueConstraint tableName="BOOK" columnNames="ISBN"/>
            <addForeignKeyConstraint baseTableName="BOOK"
                                     baseColumnNames="PUBLISHER"
                                     constraintName="FK_BOOK_PUBLISHER"
                                     referencedTableName="PUBLISHER"
                                     referencedColumnNames="PUBLISHER_ID"/>
        </changeSet>
    
        <changeSet id="7" author="daniel">
            <createTable tableName="BOOKS_AUTHORS">
                <column name="BOOK_ID" type="INTEGER">
                    <constraints primaryKey="true" nullable="false" foreignKeyName="FK_BOOKS_AUTHORS_BOOK" referencedTableName="BOOK" referencedColumnNames="BOOK_ID"/>
                </column>
                <column name="AUTHOR_ID" type="INTEGER">
                    <constraints primaryKey="true" nullable="false" foreignKeyName="FK_BOOKS_AUTHORS_AUTHOR" referencedTableName="AUTHOR" referencedColumnNames="AUTHOR_ID"/>
                </column>
            </createTable>
        </changeSet>

        <changeSet id="8" author="daniel">
            <createIndex tableName="BOOK" indexName="IDX_BOOK_NAME">
                <column name="NAME"/>
            </createIndex>
        </changeSet>

</databaseChangeLog>
